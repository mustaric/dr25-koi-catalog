
%One of the goals of NASA's astrophysics missions is to understand the Earth's place in the Universe.
\Kepler{'s} mission to measure the frequency of Earth-size planets in the Galaxy is an important step towards understanding the Earth's place in the Universe.  Launched in 2009, the \Kepler{} Mission \citep{Koch2010,Borucki2016} stared almost continuously at a single field for four years (or 17, $\approx$90~day quarters), recording the brightness of $\approx$200,000 stars ($\approx$160,000 stars at a time) at a cadence of 29.4 minutes over the course of the mission. \Kepler{} detected transiting planets by observing the periodic decrease in the observed brightness of a star when an orbiting planet crossed the line of sight from the telescope to the star. \Kepler{'s} prime-mission observations concluded in 2013 when it lost a second of four reaction wheels, three of which were required to maintain the stable pointing.  From the ashes of \Kepler{} rose the \Ktwo{} mission which continues to find exoplanets in addition to a whole host of astrophysics enabled by its observations of fields in the ecliptic \citep{Howell2014,VanCleve2016K2}. 
While not the first to obtain high-precision, long-baseline photometry to look for transiting exoplanets \citep[see e.g.,][]{Barge2008,ODonovan2006}, \Kepler{} and its plethora of planet candidates revolutionized exoplanet science. The large number of Kepler planet detections from the same telescope opened the door for occurrence rate studies and has enabled some of the first measurements of the frequency of planets similar to the Earth in our Galaxy.  To further enable those types of studies, we present here the planet catalog that resulted from the final search of the Data Release 25 (DR25) \Kepler{} mission data along with the tools provided to understand the biases inherent in the search and vetting done to create that catalog.
%In this paper we use the original four years of Kepler data to create a fully automated catalog designed to enable planetary occurrence rates, even for terrestrial-size planets in one-year orbits.

First, we put this work in context by reviewing some of the scientific achievements accomplished using \Kepler{} data.  Prior to \Kepler{,} most exoplanets were discovered by radial velocity methods \citep[e.g.][]{Mayor1995}, which largely resulted in the detection of Neptune- to Jupiter-mass planets in orbital periods of days to months. The high precision photometry and the four-year baseline of the \Kepler{} data extended the landscape of known exoplanets.  To highlight a few examples, \citet{Barclay2013} found evidence for a moon-size terrestrial planet in a 13.3 day period orbit, \citet{Quintana2014} found evidence of an Earth-size exoplanet in the habitable zone of the M dwarf Kepler-186, and \citet{Jenkins2015} statistically validated a super-Earth in the habitable zone of a G-dwarf star. Additionally, for several massive planets \Kepler{} data has enabled measurements of planetary mass and atmospheric properties by using the photometric variability along the entire orbit \citep{Shporer2011,Mazeh2012,Shporer2017}. \Kepler\ data has also revealed hundreds of compact, co-planar, multi-planet systems, e.g., the six planets around Kepler-11 \citep{Lissauer2011}, which collectively have told us a great deal about the architecture of planetary systems \citep{Lissauer2011b,Fabrycky2014}.   Exoplanets have even been found orbiting binary stars, e.g., Kepler-16~(AB)~b \citep{Doyle2011}.

Other authors have taken advantage of the long time series, near-continuous data set of 206,150\footnote{This tally only includes the targeted stars and not those observed by ``accident'' in the larger apertures.} stars to advance our understanding of stellar physics through the use of asteroseismology. Of particular interest to this catalog is the improvement in the determination of stellar radius \citep[e.g.,][]{Huber2014a,Mathur2017ApJS} which can be one of the most important sources of error when calculating planetary radii. \Kepler{} data was also used to track the evoluation of star-spots created from magnetic activity and thus enabled the measurement of stellar rotation rates \citep[e.g.][]{Aigrain2015,Garcia2014,McQuillan2014,Zimmerman2017}. Studying stars in clusters enabled \citet{Meibom2011} to map out the evolution of stellar rotation as stars age. \Kepler{} also produced light curves of 2876\footnote{This represents the number reported in the Kepler Binary Catalog, \url{http://keplerebs.villanova.edu}, in August 2017.} eclipsing binary stars \citep{Prsa2011,Kirk2016} including unusual binary systems, such as the eccentric, tidally-distorted, Heartbeat stars \citep{Welsh2011,Thompson2012,Shporer2016hb} that have opened the doors to understanding the impact of tidal forces on stellar pulsations and evolution \citep[e.g.,][]{Hambleton2017,Fuller2017}.

The wealth of astrophysics, and the size of the \Kepler{} community, is in part due to the rapid release of \Kepler{} data to the NASA Archives: the Exoplanet Archive \citep[][]{Akeson2013} and the MAST (Mikulski Archives for Space Telescopes).  The \Kepler{} mission released data from every step of the processing \citep{Thompson2016KAM,Stumpe2014,Bryson2010b}, including its planet searches. The results of both the original searches for periodic signals (known as the TCEs or Threshold Crossing Events) and the well-vetted KOIs (Kepler Objects of Interest) were made available for the community. The combined list of \Kepler{'s} planet candidates found from all searches can be found in the cumulative KOI table\footnote{\url{https://exoplanetarchive.ipac.caltech.edu/cgi-bin/ TblView/nph-tblView?app=ExoTbls\&config=cumulative}}.  The KOI table we present here is from a single search of the DR25 light curves. While the search does not include new observations, it was performed using an improved version of the \Kepler{} Pipeline \citep[version 9.3,][]{Jenkins2017}. For a high-level summary of the changes to the \Kepler{} Pipeline, see the DR25 data release notes \citep{DRN25,KDCH}. The \Kepler{} Pipeline has undergone successive improvements since launch as the data characteristics have become better understood.

%The \Kepler{} mission released data from every step of the processing, including unprocessed images, systematic-error-corrected light curves \citep{Stumpe2014}, lists of planet candidates, as well as ancillary data such as pixel response functions \citep{Bryson2010b}.
%This table is actually the combination of individual KOI tables that resulted from searches with progressively longer baselines \citep{Borucki2011a, Batalha2013, Burke2014, Rowe2015cat, Mullally2015cat,Coughlin2016}.
%The light curves used for the planet search discussed here are all part of Data Release 25 (DR25) and are described in detail in \citet{DRN25} and \citet{KDCH}.The mission cataloged the results of many of its searches for periodic transit signals in the data. 

%{\color{blue}
The photometric noise at time scales of the transit is what limits \Kepler{} from finding small terrestrial-size planets. Investigations of the noise properties of \Kepler{} exoplanet hosts by \citet{Howell2016} showed that those exoplanets with the radii $\leq$1.2\re{} are only found around the brightest, most photometrically quiet stars. As a result, the search for the truly Earth-size planets are limited to a small subset of \Kepler{'s} stellar sample.  Analyses by \citet{Gilliland2011,Gilliland2015} show that the primary source of the observed noise was indeed inherent to the stars, with a smaller contributions coming from imperfections in the instruments and software. Unfortunately, the typical noise level for 12$^{th}$ magnitude solar-type stars is closer to 30\,ppm \citep{Gilliland2015} than the 20\,ppm expected prior to launch \citep{Jenkins2002a}, causing \Kepler{} to need a longer baseline to find a significant number of Earth-like planets around Sun-like stars.   Ultimately, this higher noise level impacts \Kepler{'s} planet yield. And, because different stars have different levels of noise, the transit depth to which the search is sensitive varies across the sample of stars. This bias must be accounted for when calculating occurrence rates, and is explored in-depth for this run of the \Kepler{} Pipeline by the transit injection and recovery studies of \citet[][]{Burke2017b,Burke2017a} and \citet{Christiansen2017}.
%}
 

%%This might be a good place for a paragraph regarding follow-up observing.
%{\color{blue}
To confirm the validity and further characterize identified planet candidates, the \Kepler{} mission benefited from an active, funded, follow-up observing program. This program used ground-based radial velocity measurements to determine the mass of exoplanets \citep[e.g.,][]{Marcy2014} when possible and also ruled out other astrophysical phenomena, like background eclipsing binaries, that can mimic a transit signal.  The follow-up program obtained high-resolution imaging of $\approx$90\% of known KOIs \citep[e.g.,][]{Furlan2017} to identify close companions (bound or unbound) that would be included in \Kepler{'s} rather large 3.98\,$\arcsec$ pixels.  The extra light from these companions must be accounted for when determining the depth of the transit and the radii of the exoplanet.  While the \Kepler{} Pipeline accounts for the stray light from stars in the Kepler Input Catalog (\citealt{Brown2011}; and see flux fraction in \S2.3.1.2 of the Kepler Archive Manual; \citealt{Thompson2016KAM}), the sources identified by these high-resolution imaging catalogs were not included. Based on the analysis by \citet{Ciardi2015}, where they considered the effects of multiplicity, planet radii are underestimated by a factor averaging\,$\simeq$1.5 for G dwarfs prior to vetting, or averaging $\simeq$1.2 for KOIs that have been vetted with high-resolution imaging and Doppler spectroscopy.  The effect of unrecognized dilution decreases for planets orbiting the K and M dwarfs, because they have a smaller range of possible stellar companions
%}

%Eclipsing binary systems often mimic the signal of a transit and must be weeded out through either additional confirming data \citep[such as radial velocities, e.g.][]{Marcy2014}, or statistical analysis.

Even with rigorous vetting and follow-up observations, most planet candidates in the KOI catalogs cannot be directly confirmed as planetary. The stars are too dim and the planets are too small to be able to measure a radial velocity signature for the planet.   Statistical methods study the likelihood that the observed transit could be caused by other astrophysical scenarios and have succeeded in validating thousands of \Kepler{} planets \citep[e.g.][]{Morton2016,Torres2015,Rowe2014,Lissauer2014}.  

The Q1--Q16 KOI catalog \citep{Mullally2015cat} was the first with a long enough baseline to be significantly impacted by another source of false positives, the long-period false positives created by the instrument itself.  In that catalog (and again in this one), the majority of long-period, low SNR TCEs are ascribed to instrumental effects incompletely removed from the data before the TCE search. \Kepler\ has a variety of short timescale (on the order of a day or less), non-Gaussian noise sources including focus changes due to thermal variations, signals imprinted on the data by the detector electronics, noise caused by solar flares, and the pixel sensitivity changing after the impact of a high energy particle (known as a sudden pixel sensitivity drop-out, or SPSD). Because the large number of TCEs associated with these types of errors, and because the catalog was generated to be intentionally inclusive (i.e. high completeness), many of the long-period candidates in the Q1--Q16 KOI catalog are expected to simply be noise.  We were faced with a similar problem for the DR25 catalog and spent considerable effort writing software to identify these types of false positives, and for the first time we include an estimate for how often these signals contaminate the catalog.

The planet candidates found in \Kepler{} data have been used extensively to understand the frequency of different types of planets in the Galaxy. Many studies have shown that small planets ($<4$\re) in short period orbits are common, with occurrence rates steadily increasing with decreasing radii \citep{Burke2016,Howard2012,Petigura2013b,Youdin2011}.  \citet{Dressing2013,Dressing2015}, using their own search, confined their analysis to M dwarfs and orbital periods less than 50\,d and determined that multi-planet systems are common around these low mass stars.  Therefore planets are more common than stars in the Galaxy (due, in part, to the fact that low mass stars are the most common stellar type). 
\citet{Fulton2017}, using improved measurements of the stellar properties \citep{Petigura2017}, looked at small planets with periods of less than 100\,d and showed that there is a valley in the occurrence of planets near 1.75\re{}. This result improved upon the results of \citet{Howard2012} and \citet{Lundkvist2016} and further verified the evaporation valley predicted by \citet{Owen2013} and \citet{Lopez2013} for close-in planets.

Less is known about the occurrence of planets in longer period orbits. Using planet candidates discovered with \Kepler{}, several papers have measured the frequency of small planets in the habitable zone of sun-like stars \citep[see e.g.][]{Burke2015,ForemanMackey16,Petigura2013b} using various methods. \citet{Burke2015} used the Q1--Q16  KOI catalog \citep{Mullally2015cat} and looked at G and K stars and concluded that 10\% (with an allowed range of 1--200\%) of solar-type stars host planets with radii and orbital periods within 20\% of that of the Earth. \citet{Burke2015} considered various systematic effects and showed that they dominate the uncertainties and concluded that improved measurements of the stellar properties, the detection efficiency of the search, and the reliability of the catalog will have the most impact in narrowing the uncertainties in such studies. 


\subsection{Design Philosophy of the DR25 catalog}

The DR25 KOI catalog is designed to support rigorous occurrence rate studies. To do that well, it was critical that we not only identify the exoplanet transit signals in the data but also measure the catalog reliability (the fraction of transiting candidates that are not caused by noise), and the completeness of the catalog (the fraction of true transiting planets detected).

The measurement of the catalog completeness has been split into two parts: the completeness of the TCE list (the transit search performed by the \Kepler\ Pipeline) and the completeness of the KOI catalog (the vetting of the TCEs). The completeness of the \Kepler\ Pipeline and its search for transits has been studied by injecting transit signals into the pixels and examining what fraction are found by the \Kepler{} Pipeline \citep{Christiansen2017, Christiansen2015b,Christiansen2013a}. \citet{Burke2015} applied the appropriate detection efficiency contours \citep{Christiansen2015} to the 50--300\,d period planet candidates in the Q1--Q16 KOI catalog \citep{Mullally2015cat} in order to measure the occurrence rates of small planets. However, that study was not able to account for those transit signals correctly identified by the \Kepler{} Pipeline but thrown-out by the vetting process. Along with the DR25 KOI catalog, we provide a measure of the completeness of the DR25 vetting process. 

\Kepler{} light curves contain variability that is not due to planet transits or eclipsing binaries. While the reliability of \Kepler\ catalogs against astrophysical false positives is mostly understood \citep[see e.g.][]{Morton2016}, the reliability against false alarms (a term used in this paper to indicate TCEs caused by intrinsic stellar variability, over-contact binaries, or instrumental noise, i.e., anything that does not look transit-like) has not previously been measured. Instrumental noise, statistical fluctuations, poor detrending, and/or stellar variability can conspire to produce a signal that looks similar to a planet transit. When examining the smallest exoplanets in the longest orbital periods, \citet{Burke2015} demonstrated the importance of understanding the reliability of the catalog, showing that the occurrence of small, earth-like-period planets around G dwarf stars changed by a factor of $\approx$10 depending on the reliability of a few planet candidates.  In this catalog we measure the reliability of the reported planet candidates against this instrumental and stellar noise.  

The completeness of the vetting process is measured by vetting thousands of injected transits found by the \Kepler{} Pipeline. Catalog reliability is measured by vetting signals found in scrambled and inverted \Kepler{} light curves and counting the fraction of simulated false alarms that are dispositioned as planet candidates. This desire to vet both the real and simulated TCEs in a reproducible and consistent manner demands an entirely automated method for vetting the TCEs.  

Automated vetting was introduced in the Q1--Q16 KOI catalog \citep{Mullally2015cat} with the Centroid Robovetter and was then extended to all aspects of the vetting process for the DR24 KOI catalog \citep{Coughlin2016}. Because of this automation, the DR24 catalog was the first with a measure of completeness that extended to all parts of the search, from pixels to planet candidates.  Now, with the DR25 KOI catalog and simulated false alarms, we also provide a measure of how effective the vetting techniques are at identifying noise signals and translate that into a measure of the catalog reliability. As a result, the DR25 KOI catalog is the first to explicitly balance the gains in completeness against the loss of reliability, instead of always erring on the side of high completeness. 

%Subsection on the abbreviations
\input{abbrev.tex}

\subsection{Summary and Outline of the Paper}

The DR25 KOI catalog is a uniformly-vetted list of planet candidates and false positives found by searching the DR25 \Kepler\ light curves and includes a measure of the catalog completeness and reliability. In the brief outline that follows we highlight how the catalog was assembled, how we measure the completeness and reliability, and discuss those aspects of the process that are different from the DR24 KOI catalog \citep{Coughlin2016}.

In \S\ref{s:tces} we describe the observed TCEs (\opstce s) which are the periodic signals found in the actual \Kepler\ light curves. For reference, we also compare them to the DR24 TCEs. To create the simulated data sets necessary to measure the vetting completeness and the catalog reliability, we ran the \Kepler\ Pipeline on light curves that either contained injected transits, were inverted, or were scrambled. This creates \injtce s, \invtce s, and \scrtce s, respectively (see \S\ref{s:simulated}).  

We then created and tuned a Robovetter to vet all the different sets of TCEs. \S\ref{s:robovetter} describes the metrics and the logic used to disposition TCEs into PCs and FPs.  Because the DR25 \opstce\ population was significantly different than the DR24 \opstce{s}, we developed new metrics to separate the PCs from the FPs (see Appendix \ref{s:metrics} for the details on how each metric operates.) Several new metrics examine the individual transits for evidence of instrumental noise (see \S\ref{s:indivtrans}.) As in the DR24~KOI catalog, we group FPs into four categories (\S\ref{s:majorflags}) and provide minor false positive flags (Appendix \ref{s:minorflags}) to indicate why the Robovetter decided to pass or fail a TCE.  New to this catalog is the addition of a disposition score (\S\ref{s:scores}) that gives users a measure of the Robovetter's confidence in each disposition. 


Unlike previous catalogs, for the DR25 KOI catalog the choice of planet candidate versus false positive is no longer based on the philosophy of ``innocent until proven guilty''. We accept certain amounts of collateral damage (i.e., exoplanets dispositioned as FP) in order to achieve a catalog that is uniformly vetted and has acceptable levels of both completeness and reliability, especially for the long period and low signal-to-noise PCs. In \S\ref{s:optimize} we discuss how we tuned the Robovetter using the simulated TCEs as populations of true planet candidates and true false alarms. We provide the Robovetter source code and all the Robovetter metrics for all of the sets of TCEs (\opstces, \injtces, \invtces, and \scrtces) to enable users to create a catalog tuned for other regions of parameter space if their scientific goals require it. 

We assemble the catalog (\S\ref{s:assemble}) by federating to previously known KOIs before creating new KOIs. Then to provide planet parameters, each KOI is fit with a transit model which uses a Markov Chain Monte Carlo (MCMC) algorithm to provide error estimates for each fitted parameter (\S\ref{s:mcmc}). In \S\ref{s:summary} we summarize the catalog and discuss the performance of the vetting using the \injtce, \invtce, and \scrtce\ sets. We show that both decrease significantly with decreasing number of transits and decreasing signal-to-noise.  We then discuss how one may use the disposition scores to identify the highest quality candidates, especially at long periods (\S\ref{s:crscores}.)  We conclude that not all declared planet candidates in our catalog are actually astrophysical transits, but we can measure what fraction are caused by stellar and instrumental noise. Because of the interest in terrestrial, temperate planets, we examine the high quality, small candidates in the habitable zone in \S\ref{s:hz}. Finally, in \S\ref{s:occurates} we give an overview of what must be considered when using this catalog to measure accurate exoplanet occurrence rates, including what information is available in other \Kepler{} products to do this work. 



